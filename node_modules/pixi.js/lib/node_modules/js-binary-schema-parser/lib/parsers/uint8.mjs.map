{"version":3,"file":"uint8.mjs","sources":["../../../../../node_modules/js-binary-schema-parser/lib/parsers/uint8.js"],"sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.readBits = exports.readArray = exports.readUnsigned = exports.readString = exports.peekBytes = exports.readBytes = exports.peekByte = exports.readByte = exports.buildStream = void 0;\n\n// Default stream and parsers for Uint8TypedArray data type\nvar buildStream = function buildStream(uint8Data) {\n  return {\n    data: uint8Data,\n    pos: 0\n  };\n};\n\nexports.buildStream = buildStream;\n\nvar readByte = function readByte() {\n  return function (stream) {\n    return stream.data[stream.pos++];\n  };\n};\n\nexports.readByte = readByte;\n\nvar peekByte = function peekByte() {\n  var offset = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n  return function (stream) {\n    return stream.data[stream.pos + offset];\n  };\n};\n\nexports.peekByte = peekByte;\n\nvar readBytes = function readBytes(length) {\n  return function (stream) {\n    return stream.data.subarray(stream.pos, stream.pos += length);\n  };\n};\n\nexports.readBytes = readBytes;\n\nvar peekBytes = function peekBytes(length) {\n  return function (stream) {\n    return stream.data.subarray(stream.pos, stream.pos + length);\n  };\n};\n\nexports.peekBytes = peekBytes;\n\nvar readString = function readString(length) {\n  return function (stream) {\n    return Array.from(readBytes(length)(stream)).map(function (value) {\n      return String.fromCharCode(value);\n    }).join('');\n  };\n};\n\nexports.readString = readString;\n\nvar readUnsigned = function readUnsigned(littleEndian) {\n  return function (stream) {\n    var bytes = readBytes(2)(stream);\n    return littleEndian ? (bytes[1] << 8) + bytes[0] : (bytes[0] << 8) + bytes[1];\n  };\n};\n\nexports.readUnsigned = readUnsigned;\n\nvar readArray = function readArray(byteSize, totalOrFunc) {\n  return function (stream, result, parent) {\n    var total = typeof totalOrFunc === 'function' ? totalOrFunc(stream, result, parent) : totalOrFunc;\n    var parser = readBytes(byteSize);\n    var arr = new Array(total);\n\n    for (var i = 0; i < total; i++) {\n      arr[i] = parser(stream);\n    }\n\n    return arr;\n  };\n};\n\nexports.readArray = readArray;\n\nvar subBitsTotal = function subBitsTotal(bits, startIndex, length) {\n  var result = 0;\n\n  for (var i = 0; i < length; i++) {\n    result += bits[startIndex + i] && Math.pow(2, length - i - 1);\n  }\n\n  return result;\n};\n\nvar readBits = function readBits(schema) {\n  return function (stream) {\n    var _byte = readByte()(stream); // convert the byte to bit array\n\n\n    var bits = new Array(8);\n\n    for (var i = 0; i < 8; i++) {\n      bits[7 - i] = !!(_byte & 1 << i);\n    } // convert the bit array to values based on the schema\n\n\n    return Object.keys(schema).reduce(function (res, key) {\n      var def = schema[key];\n\n      if (def.length) {\n        res[key] = subBitsTotal(bits, def.index, def.length);\n      } else {\n        res[key] = bits[def.index];\n      }\n\n      return res;\n    }, {});\n  };\n};\n\nexports.readBits = readBits;"],"names":["buildStream","readByte","peekByte","readBytes","peekBytes","readString","readUnsigned","readArray","subBitsTotal","readBits"],"mappings":"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","x_google_ignoreList":[0]}