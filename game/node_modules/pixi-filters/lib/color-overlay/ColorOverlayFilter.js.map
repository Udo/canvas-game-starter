{"version":3,"file":"ColorOverlayFilter.js","sources":["../../src/color-overlay/ColorOverlayFilter.ts"],"sourcesContent":["import { Color, ColorSource, deprecation, Filter, GlProgram, GpuProgram } from 'pixi.js';\nimport { vertex, wgslVertex } from '../defaults';\nimport fragment from './color-overlay.frag';\nimport source from './color-overlay.wgsl';\n\ntype DeprecatedColor = number | number[] | Float32Array;\n\n/** Options for the ColorOverlayFilter constructor. */\nexport interface ColorOverlayFilterOptions\n{\n    /**\n     * The color of the overlay\n     * @default 0x000000\n     */\n    color?: ColorSource;\n    /**\n     * The alpha of the overlay\n     * @default 1\n     */\n    alpha?: number;\n}\n\n/**\n * Overlay a source graphic with a color.<br>\n *\n * @class\n * @extends Filter\n */\nexport class ColorOverlayFilter extends Filter\n{\n    /** Default shockwave filter options */\n    public static readonly DEFAULT_OPTIONS: ColorOverlayFilterOptions = {\n        /** The color of the overlay */\n        color: 0x000000,\n        /** The alpha of the overlay */\n        alpha: 1,\n    };\n\n    public uniforms: {\n        uColor: Float32Array;\n        uAlpha: number;\n    };\n\n    private _color: Color;\n\n    /**\n     * @param options - Options for the ColorOverlayFilter constructor.\n     */\n    constructor(options?: ColorOverlayFilterOptions);\n    /**\n     * @deprecated since 6.0.0\n     *\n     * @param {number|Array<number>} [color=0x000000] - The resulting color, as a 3 component RGB e.g. [1.0, 0.5, 1.0]\n     * @param {number} [alpha=1] - The alpha value of the color\n     */\n    constructor(color?: DeprecatedColor, alpha?: number);\n    /** @ignore */\n    constructor(...args: [ColorOverlayFilterOptions?] | [DeprecatedColor?, number?])\n    {\n        let options = args[0] ?? {};\n\n        if (typeof options === 'number' || Array.isArray(options) || options instanceof Float32Array)\n        {\n            // eslint-disable-next-line max-len\n            deprecation('6.0.0', 'ColorOverlayFilter constructor params are now options object. See params: { color, alpha }');\n\n            options = { color: options };\n\n            if (args[1] !== undefined) options.alpha = args[1];\n        }\n\n        options = { ...ColorOverlayFilter.DEFAULT_OPTIONS, ...options };\n\n        const gpuProgram = GpuProgram.from({\n            vertex: {\n                source: wgslVertex,\n                entryPoint: 'mainVertex',\n            },\n            fragment: {\n                source,\n                entryPoint: 'mainFragment',\n            },\n        });\n\n        const glProgram = GlProgram.from({\n            vertex,\n            fragment,\n            name: 'color-overlay-filter',\n        });\n\n        super({\n            gpuProgram,\n            glProgram,\n            resources: {\n                colorOverlayUniforms: {\n                    uColor: { value: new Float32Array(3), type: 'vec3<f32>' },\n                    uAlpha: { value: options.alpha, type: 'f32' },\n                },\n            },\n        });\n\n        this.uniforms = this.resources.colorOverlayUniforms.uniforms;\n\n        this._color = new Color();\n        this.color = options.color ?? 0x000000;\n    }\n\n    /**\n     * The over color source\n     * @member {number|Array<number>|Float32Array}\n     * @default 0x000000\n     */\n    get color(): ColorSource { return this._color.value as ColorSource; }\n    set color(value: ColorSource)\n    {\n        this._color.setValue(value);\n        const [r, g, b] = this._color.toArray();\n\n        this.uniforms.uColor[0] = r;\n        this.uniforms.uColor[1] = g;\n        this.uniforms.uColor[2] = b;\n    }\n\n    /**\n     * The alpha value of the color\n     * @default 1\n     */\n    get alpha(): number { return this.uniforms.uAlpha; }\n    set alpha(value: number) { this.uniforms.uAlpha = value; }\n}\n"],"names":["Filter","deprecation","GpuProgram","wgslVertex","source","GlProgram","vertex","fragment","Color"],"mappings":"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"}